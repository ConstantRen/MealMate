<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/styles.css">
    <title>Signup Page</title>
</head>
<body>
    <header>
        < <div class="logo">
            <img src="images/logo.png" alt="logo" class="logo-image">
        </div>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="recipe.html">Recipe Discovery</a></li>
                <li><a href="nutritionPlan.html">Nutrition Tracking / Meal Plan</a></li>
                <li><a href="signIN.html">Sign Up</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <div class="container">
            <div class="signup">
                <h2>Sign Up</h2>
                <input type="text" id="signup-username" placeholder="Username" required> <!-- Username Field -->
                <input type="email" id="signup-email" placeholder="Email" required>
                <input type="password" id="signup-password" placeholder="Password" required>
                <input type="password" id="confirm-password" placeholder="Confirm Password" required>
                <button id="signup-button">Sign Up</button>
            </div>
            
            <div class="line"></div>
            <div class="signin">
                <h2>Sign In</h2>
                <input type="email" id="signin-email" placeholder="Email" required>
                <input type="password" id="signin-password" placeholder="Password" required>
                <div class="remember">
                    <label for="remember">Remember me</label>
                    <input type="checkbox" id="remember">
                    <a href="#" class="forgot-password">Forgot password?</a>
                </div>
                <button id="signin-button">Sign In</button>
            </div>
        </div>
        <div class="image-container">
            <img src="/images/heaps-herbs-vegetables-removebg-preview.png" alt="Model with Apple" class="food-image">
            <img src="/images/beautiful-sportive-woman-posing-holding-apple-removebg-preview.png" alt="Model with Apple" class="model-image">
        </div>
    </main>

    <script>
       // Handle Sign In
       document.getElementById('signin-button').addEventListener('click', async (event) => {
    event.preventDefault();

    const email = document.getElementById('signin-email').value;
    const password = document.getElementById('signin-password').value;

    try {
        const response = await fetch('http://localhost:5000/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ email, password }),
        });

        const data = await response.json();
        console.log('Login response:', data); // Log the entire response

        if (response.ok) {
            localStorage.setItem('token', data.token);  // Store the JWT token
            
            if (data.userId) {
                localStorage.setItem('userId', data.userId);  // Store the userId
                console.log('User ID stored:', data.userId); // Log the userId
            } else {
                console.error('User ID not found in response');
            }
            
            alert('Login successful!');
            window.location.href = '/';  // Redirect to the landing page
        } else {
            alert(data.message);
        }
    } catch (error) {
        console.error('Error:', error);
    }
});
// Handle Sign Up
document.getElementById('signup-button').addEventListener('click', async (event) => {
    event.preventDefault();

    const username = document.getElementById('signup-username').value;
    const email = document.getElementById('signup-email').value;
    const password = document.getElementById('signup-password').value;
    const confirmPassword = document.getElementById('confirm-password').value;

    if (password !== confirmPassword) {
        alert('Passwords do not match');
        return;
    }

    try {
        const response = await fetch('http://localhost:5000/register', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ username, email, password }),
        });

        const data = await response.json();
        if (response.ok) {
            alert('Registration successful! Please sign in.');
            window.location.href = '/'; // Redirect to the landing page
        } else {
            alert(data.message);
        }
    } catch (error) {
        console.error('Error:', error);
    }
});

    </script>
    
</body>
</html>
